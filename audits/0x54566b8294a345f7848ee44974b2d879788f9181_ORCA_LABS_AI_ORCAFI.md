# üîç ORCA LABS AI (ORCAFI) - AI Security Audit

## üìä Audit Information

| Property | Value |
|----------|-------|
| **Audit Revision** | 1 |
| **Audit Date** | 2026-01-01T08:35:16.765Z (UTC) |
| **Blockchain** | BNB Smart Chain |
| **Contract Address** | `0x54566b8294a345f7848ee44974b2d879788f9181` |
| **AI Models Used** | 1 model(s) |

## üìã Token Information

| Property | Value |
|----------|-------|
| **Token Name** | ORCA LABS AI |
| **Symbol** | ORCAFI |

---

## ü§ñ Analysis #1: GPT-5

**Completed:** Thu, 01 Jan 2026 08:35:16 GMT

### Summary

`ORCAFI` is a custom `ERC20` token with 9 decimals implementing fixed buy/sell taxes (1% marketing + 1% validator) and a basic swap-back mechanism on BSC using PancakeSwap V2. Key characteristics: owner-controlled fee exemptions, trading gate via `tradingAllowed`, and automatic tax conversion distributing BNB to `marketingAddress` and `validatorAddress`. Overall, the code is concise with no proxy or mint-after-deploy paths; main risks are centralization of funds and a few design issues that can misallocate validator rewards. Overall Risk: MEDIUM - Centralized fund control and tax/pair design weaknesses, but no critical backdoors or upgrade risks identified.

### Risk Assessment

**Token Quick Facts:**

| Property | Value | Status |
|----------|-------|--------|
| Buy Tax | 2% total (1% marketing + 1% validator) | ‚úÖ Low |
| Sell Tax | 2% total (1% marketing + 1% validator) | ‚úÖ Low |
| Max Transaction | None | ‚úÖ No artificial limits |
| Contract Type | Standard (non-upgradeable) | Info |
| Ownership | Active (owner set) | ‚ö†Ô∏è Centralized |
| Pause Function | Trading gate (`tradingAllowed`) | ‚ö†Ô∏è Can block trading until enabled |

**Security Assessment:**

| Category | Risk Level | Notes |
|----------|------------|-------|
| Security | Medium | External calls during transfers; swap uses amountOutMin=0 |
| Centralization | Medium | Owner controls exemptions and fund addresses; public sweep sends all BNB to marketing |
| Code Quality | Medium | Simple and clear; limited events; non-extensible AMM pairs |
| Exploit Likelihood | Low | No critical attack paths observed; issues are design/centralization related |
| **Overall Risk Score** | **88/100** | 0 critical, 0 high, 3 medium, 4 low ‚Üí

## On-Chain Function Results

The following functions were called on-chain at block 73672152. The table below shows the results:

| Function | On-Chain Value | Explanation |
|----------|----------------|-------------|
| `DEAD()` | `0x000000000000000000000000000000000000dEaD` | Burn address for irrecoverable token sends |
| `FEE_DIVISOR()` | `10000` | Basis points denominator (100 = 1%) |
| `WETH()` | `0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c` | Wrapped BNB token on BSC (WBNB) |
| `buyTax()` | `["100","100"]` | Buy tax: 1% marketing, 1% validator |
| `decimals()` | `9` | UI precision for token amounts |
| `dexRouter()` | `0x10ED43C718714eb63d5aA57B78B54704E256024E` | PancakeSwap V2 Router (BSC mainnet) |
| `lastSwapBackBlock()` | `0` | No swap-back executed yet |
| `lpPair()` | `0xd1107cA83d4dD4dcD6c402B5fB39187e6E658b1c` | Token/WBNB Pancake pair created at deploy |
| `marketingAddress()` | `0x9E0AdF5D29e6cA15CE840712e302EF06e0f2A7BC` | Recipient of marketing BNB and rescues |
| `name()` | `ORCA LABS AI` | Contract name identifier |
| `owner()` | `0x9E0AdF5D29e6cA15CE840712e302EF06e0f2A7BC` | Admin address with owner privileges |
| `sellTax()` | `["100","100"]` | Sell tax: 1% marketing, 1% validator |
| `swapTokensAtAmt()` | `500000000000000` | Swap threshold (~0.05% of total supply) |
| `symbol()` | `ORCAFI` | Contract ticker |
| `totalSupply()` | `1000000000000000000` | 1,000,000,000 tokens (9 decimals) |
| `tradingAllowed()` | `false` | Trading not yet enabled for non-exempt |
| `validatorAddress()` | `0x9E0AdF5D29e6cA15CE840712e302EF06e0f2A7BC` | Recipient of validator BNB rewards |

### Findings Summary

| Severity | Count | Key Issues |
|----------|-------|------------|
| Critical | 0 | ‚Äî |
| High | 0 | ‚Äî |
| Medium | 3 | Reentrancy exposure via external calls; Public BNB sweep can divert validator share; Non-extensible AMM pair list allows tax bypass |
| Low | 4 | Slippage control set to 0; Router pre-approval for owner; Distribution uses buyTax for all swaps; Missing events for some admin updates |

### Critical Findings

None.

### High Findings

None.

### Medium Findings

---

#### üü° [M-1] External value transfers inside `convertTaxes()` during `_transfer()` path (reentrancy surface)

**Description:**
`convertTaxes()` performs external `call` with value to `marketingAddress` and `validatorAddress` while being reachable from `handleTax()` inside `_transfer()`. Although gas is limited to 35,000 and Solidity 0.8 prevents arithmetic overflows, external fallback code at these addresses could still re-enter contract functions (e.g., `transfer`, admin functions if owner-controlled), creating an avoidable reentrancy surface.

```solidity
(success, ) = marketingAddress.call{ value: marketingShare, gas: 35000 }("");
...
(success, ) = validatorAddress.call{ value: remainingBalance, gas: 35000 }("");
```

**Impact:**
Potential reentrancy into token flows or admin setters if the address is a contract with a payable fallback. Practical impact is reduced by gas limit and exemption checks but still violates Checks-Effects-Interactions best practices.

**Location:**
`convertTaxes()` in `ORCAFI`

**üí° Recommendation:**
> **Action Required:**
> 1. Add a `nonReentrant` guard to the transfer tax path, or
> 2. Use a pull-payment model: record proceeds and let recipients withdraw, or
> 3. Move external calls after all state changes, or send to a trusted immutable payout contract that then fans out.

---

#### üü° [M-2] Anyone can sweep all BNB to `marketingAddress` via `withdrawStuckBNB()`, bypassing validator allocation

**Description:**
`withdrawStuckBNB()` is public (no access control) and transfers the entire BNB balance to `marketingAddress`. If `convertTaxes()` fails to pay the validator (e.g., due to gas limit or address constraints), any caller can move all BNB to marketing, permanently skipping the validator share.

```solidity
function withdrawStuckBNB() external {
    bool success;
    (success, ) = address(marketingAddress).call{ value: address(this).balance }("");
}
```

**Impact:**
Validator rewards can be diverted to marketing, breaking intended tokenomics. With current on-chain data, `marketingAddress` equals `validatorAddress`, so no immediate impact; however, if `validatorAddress` is later changed, this becomes a real misallocation vector.

**Location:**
`withdrawStuckBNB()` in `ORCAFI`

**üí° Recommendation:**
> **Action Required:**
> 1. Split withdrawals in proportion to configured taxes (e.g., pay both `marketingAddress` and `validatorAddress`), or
> 2. Restrict to `onlyOwner` and enforce proportional payout, or
> 3. Remove this function and rely on robust payout in `convertTaxes()` or an escrow/pull model.

---

#### üü° [M-3] Taxes apply only to a single hardcoded AMM pair with no ability to add/remove pairs

**Description:**
The contract sets `isAMMPair[lpPair] = true` for the initial Pancake pair but provides no method to add other AMM pairs. Tax logic in `handleTax()` relies on `isAMMPair` to determine buy/sell classification.

```solidity
isAMMPair[lpPair] = true;
// No function to set additional pairs
```

**Impact:**
Trades routed through other liquidity pools (e.g., alternative DEX or new pair) will not be taxed, allowing tax bypass and undermining tokenomics if secondary pools appear.

**Location:**
Constructor and `isAMMPair` usage in `ORCAFI`

**üí° Recommendation:**
> **Action Required:**
> 1. Add an `onlyOwner` function to manage the `isAMMPair` mapping,
> 2. Optionally also allow removal to handle pool migrations,
> 3. Emit events on updates for transparency.

---

### Low Findings

---

#### üü¢ [L-1] No slippage protection when swapping taxes (amountOutMin = 0)

**Description:**
`swapExactTokensForETHSupportingFeeOnTransferTokens` uses `amountOutMin = 0`, exposing tax swaps to MEV and poor execution in thin liquidity.

```solidity
dexRouter.swapExactTokensForETHSupportingFeeOnTransferTokens(
    tokenAmt,
    0,
    path,
    address(this),
    block.timestamp
);
```

**Impact:**
Possible poor rates on swaps; higher price impact and vulnerability to sandwich attacks. Limited by moderate swap sizes (thresholded).

**Location:**
`swapTokensForETH()` in `ORCAFI`

**üí° Recommendation:**
> **Action Required:** Set a conservative `amountOutMin` based on a TWAP/Oracle or recent on-chain quote; consider splitting swaps.

---

#### üü¢ [L-2] Router pre-approval for owner address is unusual

**Description:**
The constructor approves the router to spend `msg.sender`‚Äôs entire balance. Though Pancake router won‚Äôt arbitrarily drain funds and `transferFrom` checks `msg.sender` (the router), this is atypical and unnecessary.

```solidity
_approve(address(msg.sender), address(dexRouter), totalSupply());
```

**Impact:**
No direct exploit with standard router, but surprising and unnecessary approval on the deployer‚Äôs funds.

**Location:**
Constructor in `ORCAFI`

**üí° Recommendation:**
> **Action Required:** Remove this approval; the deployer should explicitly approve when adding liquidity.

---

#### üü¢ [L-3] Distribution split uses `buyTax` values regardless of buy/sell origin

**Description:**
After swapping taxes, the contract uses `buyTax.marketingTax` and `buyTax.validatorReward` to split BNB, even if the accumulation originated from sells. Currently buy/sell taxes are equal, so it‚Äôs harmless but brittle.

```solidity
uint256 totalTax = buyTax.marketingTax + buyTax.validatorReward;
uint256 marketingShare = (bnbBalance * buyTax.marketingTax) / totalTax;
```

**Impact:**
If future versions ever diverge buy vs sell tax rates, distribution would be inconsistent with actual accrual.

**Location:**
`convertTaxes()` in `ORCAFI`

**üí° Recommendation:**
> **Action Required:** Track accrued shares per category during collection or use a unified rate source matching actual accrual.

---

#### üü¢ [L-4] Missing events for some admin updates

**Description:**
`updateMarketingAddress()` and `updateValidatorAddress()` don‚Äôt emit events, reducing transparency compared to `SetExemptFromFees`.

```solidity
function updateMarketingAddress(address _address) external onlyOwner { ... }
function updateValidatorAddress(address _address) external onlyOwner { ... }
```

**Impact:**
Harder for users/tools to monitor critical address changes.

**Location:**
Admin functions in `ORCAFI`

**üí° Recommendation:**
> **Action Required:** Emit events on marketing/validator address updates.

---

### Good Practices

- Uses Solidity 0.8.26 (built-in overflow checks).
- No upgradeability or proxy pattern; no delegatecall.
- No mint/burn functions exposed post-deploy; supply fixed at deployment.
- Taxes are modest and immutable in this version (no tax update functions).
- OZ-like `Address` and `SafeERC20` patterns with no suspicious modifications detected.

### Tokenomics Analysis

| Feature | Value/Status | Risk Assessment |
|---------|--------------|-----------------|
| Contract Type | Standard (non-upgradeable) | Low |
| Upgrade Control | None (no proxy) | Low |
| Ownership Status | Active (not renounced) | Medium (centralization) |
| Owner Address | 0x9E0A...A7BC | Current owner |
| Total Supply | 1,000,000,000 (9 decimals) | Low |
| Buy Tax | 2% total (1% + 1%) | Low |
| Sell Tax | 2% total (1% + 1%) | Low |
| Max Transaction | None | Low |

Details:
- Collection: On buys (from `isAMMPair[from]`) and sells (to `isAMMPair[to]`), total 2% tax is taken and transferred to the contract. Wallet-to-wallet transfers are untaxed.
- Conversion: When the contract‚Äôs token balance exceeds `swapTokensAtAmt` (~0.05% of supply) and not in the same block as last swap, it swaps to BNB and splits to `marketingAddress` and `validatorAddress` based on configured buy tax proportions.
- Centralization: Owner can:
  - Enable trading (`tradingAllowed`), otherwise only exempt addresses can transfer.
  - Exempt addresses from fees and trading gate.
  - Change `marketingAddress`/`validatorAddress`.
  - Sweep all BNB to marketing via public `withdrawStuckBNB()` (bypasses validator share).
  - Rescue any ERC20 tokens to marketing (including this token‚Äôs tax accumulation) via `rescueTokens()` if called by `marketingAddress`.

Balanced Assessment: The contract is not upgradeable, which reduces upgrade risk. However, centralized fund control and non-extensible AMM pair logic can undermine intended tokenomics (especially validator payouts and tax coverage on new pairs). For users, the main trust assumption is on the owner-controlled addresses and their management of liquidity and trading activation. Ownership is currently not renounced; if renounced in the future, note that fund sweep/rescue still operate via `marketingAddress` (not owner), preserving centralization over funds even after renounce.

---

## ‚ö†Ô∏è Important Disclaimer

> **This is an AI-generated audit and should NOT be considered as professional security advice.**

This automated analysis:
- ‚úÖ Provides quick security insights using advanced AI models
- ‚ùå May contain errors or miss critical vulnerabilities
- ‚ùå Cannot replace professional security audits
- ‚ùå Should not be used as the sole basis for investment decisions

**Always conduct thorough manual audits by qualified security professionals before:**
- Deploying smart contracts to production
- Investing significant funds
- Making critical security decisions

---

<sub>Generated by CheesePad AI Token Audit System</sub>
