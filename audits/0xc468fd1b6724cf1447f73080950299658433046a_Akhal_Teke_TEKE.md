# üîç Akhal Teke (TEKE) - AI Security Audit

## üìä Audit Information

| Property | Value |
|----------|-------|
| **Audit Revision** | 4 |
| **Audit Date** | 2025-11-19T04:20:11.788Z (UTC) |
| **Blockchain** | BNB Smart Chain |
| **Contract Address** | `0xc468fd1b6724cf1447f73080950299658433046a` |
| **AI Models Used** | 1 model(s) |

## üìã Token Information

| Property | Value |
|----------|-------|
| **Token Name** | Akhal Teke |
| **Symbol** | TEKE |

---

## ü§ñ Analysis #1: GPT-5

**Completed:** Wed, 19 Nov 2025 04:20:11 GMT

### Summary

This is a custom `ERC20` token (`TEKE`) with 9 decimals and a fixed buy/sell tax of 2% routed to the contract, later swapped to BNB and distributed 60% to `marketingAddress` and 40% to `devAddress`. Transfers are blocked until `tradingAllowed` is enabled; fee exemptions exist. No upgradeability or blacklist; notable centralization stems from the fee wallet controls and rescue functions. Overall Risk: LOW/MEDIUM - No critical vulnerabilities detected; centralization in fee handling and some low/medium logic risks.

### Risk Assessment

**Token Quick Facts:**

| Property | Value | Status |
|----------|-------|--------|
| Buy Tax | 2% (200/10000) | ‚úÖ Low |
| Sell Tax | 2% (200/10000) | ‚úÖ Low |
| Max Transaction | None | ‚úÖ No restriction |
| Contract Type | Standard (non-upgradeable) | Info |
| Ownership | Active (owner set) | ‚ö†Ô∏è Centralized |
| Pause Function | Trading gate until enabled | ‚ö†Ô∏è Can delay launch |

**Security Assessment:**

| Category | Risk Level | Notes |
|----------|------------|-------|
| Security | Low | No critical vulns; minor reentrancy surface with limited impact |
| Centralization | Medium | Owner controls exemptions, wallets; marketing can extract tokens/BNB |
| Code Quality | Medium | Sound overall; a few design quirks and visibility/typing nits |
| Exploit Likelihood | Low | No obvious exploit path for user loss beyond fee/ops centralization |
| **Overall Risk Score** | **90/100** | No critical/high items; 2 medium + 4 low issues |

## On-Chain Function Results

The following functions were called on-chain at block 68697305.

| Function | On-Chain Value | Explanation |
|----------|----------------|-------------|
| `DEAD()` | `0x000000000000000000000000000000000000dEaD` | Burn sink address used for irrevocable token burns |
| `FEE_DIVISOR()` | `10000` | Basis for fee calculation (basis points, 10000 = 100%) |
| `WETH()` | `0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c` | WBNB address on BSC used for swaps/liquidity |
| `buyTax()` | `200` | 2% buy tax (to contract, later swapped and distributed) |
| `decimals()` | `9` | Token uses 9 decimal places |
| `devAddress()` | `0x14e5281d7F9888D94A1beE1a074a2e24Ea9a2136` | Dev wallet receiving 40% of swapped BNB |
| `dexRouter()` | `0x10ED43C718714eb63d5aA57B78B54704E256024E` | PancakeSwap V2 router on BSC |
| `lastSwapBackBlock()` | `0` | No tax swap has occurred yet |
| `lpPair()` | `0xc79d97FE67BA4549A83d0C7C07d0bA7a1dfDB9c9` | Token/WBNB Pancake V2 pair address |
| `marketingAddress()` | `0x14e5281d7F9888D94A1beE1a074a2e24Ea9a2136` | Marketing wallet receiving 60% of swapped BNB |
| `name()` | `Akhal Teke` | Contract name identifier |
| `owner()` | `0x14e5281d7F9888D94A1beE1a074a2e24Ea9a2136` | Address with `onlyOwner` admin privileges |
| `sellTax()` | `200` | 2% sell tax (to contract, later swapped and distributed) |
| `swapTokensAtAmt()` | `44444444000000` | Swap trigger threshold (~0.05% of total supply) |
| `symbol()` | `TEKE` | Token symbol |
| `totalSupply()` | `88888888000000000` | 88,888,888 TEKE with 9 decimals |
| `tradingAllowed()` | `false` | Trading not yet enabled for non-exempt users |

### Findings Summary

| Severity | Count | Key Issues |
|---------|-------|------------|
| Critical | 0 | ‚Äî |
| High | 0 | ‚Äî |
| Medium | 2 | Marketing-controlled token rescues; AMM pair list not maintainable |
| Low | 4 | Anyone can drain contract BNB to marketing; minor reentrancy surface; uint128 narrowing; router pre-approval for owner |

### Critical Findings

None.

### High Findings

None.

### Medium Findings

---

#### üü† [H-1] Marketing can extract any ERC20 (including taxed TEKE) from contract at any time

**Description:**
The `marketingAddress` can call `rescueTokens()` to transfer any ERC20 held by the contract (including accumulated TEKE tax tokens) directly to itself. This allows bypassing the intended swap-and-distribute flow and could result in selling pressure if marketing dumps rescued TEKE.

```solidity
function rescueTokens(address _token) external {
    require(msg.sender == marketingAddress, "Not marketing");
    require(_token != address(0), "_token address cannot be 0");
    uint256 _contractBalance = IERC20(_token).balanceOf(address(this));
    SafeERC20.safeTransfer(
        IERC20(_token),
        address(marketingAddress),
        _contractBalance
    );
}
```

**Impact:**
- Marketing can seize all accumulated TEKE tax tokens and sell them, creating unexpected sell pressure.
- Deviates from advertised tax usage; users may expect automatic swaps to BNB.

**Location:**
`rescueTokens()` in `TEKE`.

**üí° Recommendation:**
> **Action Required:**
> 1. Restrict `rescueTokens(address(this))` or exclude the native token from rescues.
> 2. If rescue is needed, restrict to non-native tokens and/or onlyOwner with time-lock/multisig.
> 3. Emit an event and possibly cap frequency/amount.

---

#### üü† [H-2] Tax logic only recognizes a single AMM pair; trades via other pairs may avoid intended taxation

**Description:**
Tax classification relies on `isAMMPair` mapping which is set only for `lpPair` in the constructor. There is no function to add more AMM pairs. Trades via any other pair (e.g., new pools or other DEXs) will be treated as regular transfers with no tax.

```solidity
isAMMPair[lpPair] = true;
// No function to add/remove other AMM pairs
```

**Impact:**
- Tax avoidance possible through alternative liquidity pools.
- Projects expecting chain-wide taxation may see revenue leakage.

**Location:**
`constructor()` and `handleTax()` logic.

**üí° Recommendation:**
> **Action Required:**
> 1. Add `onlyOwner` function to manage `isAMMPair[address]`.
> 2. Optionally auto-detect pairs via known factories, with safeguards.

---

### Low Findings

---

#### üü¢ [L-1] Anyone can trigger `withdrawStuckBNB()` to send all BNB to `marketingAddress`, bypassing dev split

**Description:**
`withdrawStuckBNB()` is public and sends 100% of the contract‚Äôs BNB to `marketingAddress`, bypassing the 60/40 split enforced in `convertTaxes()`. Anyone can trigger it; funds always go to marketing.

```solidity
function withdrawStuckBNB() external {
    bool success;
    (success, ) = address(marketingAddress).call{
        value: address(this).balance
    }("");
}
```

**Impact:**
- Dev wallet may receive less/no funds than intended if marketing (or anyone) drains BNB before `convertTaxes()`.
- Not a user funds risk, but a revenue-split integrity issue.

**Location:**
`withdrawStuckBNB()` in `TEKE`.

**üí° Recommendation:**
> **Action Required:**
> 1. Restrict to `onlyOwner` or both `marketingAddress` and `devAddress` governance.
> 2. Enforce 60/40 split in any BNB withdrawal path.

---

#### üü¢ [L-2] Minor reentrancy surface in `convertTaxes()` due to external calls without a guard

**Description:**
`convertTaxes()` calls the DEX router and then performs two `.call{gas:35000}` ETH sends to `marketingAddress` and `devAddress`. While state changes are minimal, a malicious fallback could attempt reentry into token functions.

```solidity
swapTokensForETH(contractBalance);
// ...
(success, ) = marketingAddress.call{value: marketingShare, gas: 35000}("");
// ...
(success, ) = devAddress.call{value: remainingBalance, gas: 35000}("");
```

**Impact:**
- Limited given minimal mutable state and block gating (`lastSwapBackBlock + 1 <= block.number`), but a reentrant path could trigger additional transfers or gas griefing.

**Location:**
`convertTaxes()` in `TEKE`.

**üí° Recommendation:**
> **Action Required:**
> 1. Add a simple nonReentrant guard around `convertTaxes()` and swap entry.
> 2. Use Checks-Effects-Interactions pattern and set `lastSwapBackBlock` before external calls.

---

#### üü¢ [L-3] Unnecessary narrowing to `uint128` for `tax` could truncate on extremely large supplies

**Description:**
`tax` is stored in a `uint128` before returning as `uint256`. For this token‚Äôs supply the value is safe, but the pattern is error-prone.

```solidity
uint128 tax = 0;
// ...
tax = uint128((amount * taxes.marketingTax) / FEE_DIVISOR);
return tax; // implicit widening back to uint256
```

**Impact:**
- No issue with current `totalSupply`, but unsafe style if reused with larger supplies.

**Location:**
`handleTax()`.

**üí° Recommendation:**
> **Action Required:**
> 1. Use `uint256 tax` to avoid narrowing and potential truncation.

---

#### üü¢ [L-4] Router pre-approval for owner address and unlimited router approval for contract

**Description:**
The constructor grants `dexRouter` an allowance of `totalSupply()` from the deployer address, and unlimited allowance from the contract. While typical for LP operations, large allowances are unnecessary long-term.

```solidity
_approve(address(this), address(dexRouter), type(uint256).max);
_approve(address(msg.sender), address(dexRouter), totalSupply());
```

**Impact:**
- If the router is upgraded maliciously (out of contract‚Äôs control) or misused, excessive approvals increase risk.
- Owner EOA can revoke, but it‚Äôs easy to overlook.

**Location:**
Constructor of `TEKE`.

**üí° Recommendation:**
> **Action Required:**
> 1. After initial liquidity, reduce/revoke allowances where possible.
> 2. Approve exact/spending-on-demand amounts.

---

### Good Practices

- Uses standard, unmodified fee flow and OpenZeppelin-style `ERC20`/`Ownable` patterns (no hidden owner restore/backdoors).
- Fixed tax rates (2% buy/sell) with no owner setters reduces rug vectors from tax spikes.
- `tradingAllowed` cannot be disabled once enabled, preventing post-launch freezes.
- `swapExactTokensForETHSupportingFeeOnTransferTokens` helps avoid transfer tax issues on swap.

### Tokenomics Analysis

| Feature | Value/Status | Risk Assessment |
|---------|--------------|-----------------|
| Contract Type | Standard (no proxy) | Low |
| Upgrade Control | N/A (immutable code) | Low |
| Ownership Status | Active | Medium (centralized controls) |
| Owner Address | 0x14e5...2136 | Current admin |
| Total Supply | 88,888,888 (9 decimals) | Low |
| Buy Tax | 2% (marketing) | Low |
| Sell Tax | 2% (marketing) | Low |
| Max Transaction | None | Low |

- Fees: On buys/sells, 2% is taken and stored in the contract, then swapped for BNB at a threshold (~0.05% of supply). Distribution: 60% to `marketingAddress`, 40% to `devAddress`.
- Centralization: `owner` controls fee exemptions, fee wallets, and swap threshold. `marketingAddress` can extract any ERC20 from the contract (including TEKE), and anyone can redirect all BNB to marketing via `withdrawStuckBNB()`. These do not stop trading or steal user tokens but affect operations and fee distribution integrity.
- Honeypot: No transfer blockers after enabling trading; taxes are symmetric buy/sell; no hidden maxTx or blacklist. Not a honeypot based on code.
- Liquidity: No built-in LP lock; team processes are off-chain. Users should verify LP lock/burn on-chain.

### Ownership, Renunciation, and Proxy

- Ownership Renunciation Verification: `Ownable` is straightforward; `renounceOwnership()` sets `owner` to `address(0)` with no restore or alternate owner variables. No fake renounce pattern detected. Note: even post-renounce, `marketingAddress` retains `rescueTokens()` capability.
- Proxy Detection: No proxy or upgradeability found; no `delegatecall`, EIP-1967/1822 slots, or upgrade paths. Upgrade risk: Low.

---

## ‚ö†Ô∏è Important Disclaimer

> **This is an AI-generated audit and should NOT be considered as professional security advice.**

This automated analysis:
- ‚úÖ Provides quick security insights using advanced AI models
- ‚ùå May contain errors or miss critical vulnerabilities
- ‚ùå Cannot replace professional security audits
- ‚ùå Should not be used as the sole basis for investment decisions

**Always conduct thorough manual audits by qualified security professionals before:**
- Deploying smart contracts to production
- Investing significant funds
- Making critical security decisions

---

<sub>Generated by CheesePad AI Token Audit System</sub>
