# üîç White Rat (WR) - AI Security Audit

## üìä Audit Information

| Property | Value |
|----------|-------|
| **Audit Revision** | 1 |
| **Audit Date** | 2025-12-09T07:25:13.867Z (UTC) |
| **Blockchain** | BNB Smart Chain |
| **Contract Address** | `0x50e0de39e80b55fe2a29464c105a2823c11e83d4` |
| **AI Models Used** | 1 model(s) |

## üìã Token Information

| Property | Value |
|----------|-------|
| **Token Name** | White Rat |
| **Symbol** | WR |

---

## ü§ñ Analysis #1: GPT-5

**Completed:** Tue, 09 Dec 2025 07:25:13 GMT

### Summary

This is a taxed `ERC20` token (`WR`) with 9 decimals and owner-controlled parameters. It routes swap taxes to `marketingAddress` (60%) and `devAddress` (40%), and enforces an owner-tunable anti-bot window applying a punitive 90% tax. There is no proxy or upgradeability, but strong centralization remains: owner can enable a long 90% tax window and set buy/sell taxes up to 30% anytime. Overall Risk: HIGH - Heavy owner-controlled taxation and centralization, though no hidden backdoors or proxy.

### Risk Assessment

**Token Quick Facts:**

| Property | Value | Status |
|----------|-------|--------|
| Buy Tax | 5% (owner-adjustable up to 30%) | ‚ö†Ô∏è High |
| Sell Tax | 5% (owner-adjustable up to 30%) | ‚ö†Ô∏è High |
| Max Transaction | None | ‚úÖ Reasonable |
| Contract Type | Standard (non-proxy) | Info |
| Ownership | Active (owner present: `0xc1AD...5065`) | ‚ö†Ô∏è Centralized |
| Pause Function | Trading gate (pre-trade off, then on) | ‚ö†Ô∏è Can halt trading for non-exempt |

**Security Assessment:**

| Category | Risk Level | Notes |
|----------|------------|-------|
| Security | Medium | No reentrancy guards around external calls; minor concerns but no direct exploit found |
| Centralization | High | Owner can set 90% anti-bot duration, 30% taxes, addresses, exemptions |
| Code Quality | Medium | Mostly OZ-style; a few logic/design quirks (withdraw sends 100% to marketing) |
| Exploit Likelihood | Low | No obvious critical exploits; risks are governance/parameter abuse |
| **Overall Risk Score** | **84/100** | 0 critical, 2 high, 1 medium, 3 low findings |

## On-Chain Function Results

| Function | On-Chain Value | Explanation |
|----------|----------------|-------------|
| `DEAD()` | `0x000000000000000000000000000000000000dEaD` | Burn address used to permanently remove tokens |
| `FEE_DIVISOR()` | `10000` | Basis points divisor for tax calculations (10000 = 100%) |
| `WETH()` | `0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c` | Wrapped BNB used for swaps/liquidity on BSC |
| `buyTax()` | `500` | Current buy tax rate in basis points (5%) |
| `decimals()` | `9` | Token uses 9 decimal places |
| `devAddress()` | `0xc1AD0b38030c11bA80f5D7f3dF1f964b782b5065` | Receives 40% of swapped ETH (owner-controlled) |
| `dexRouter()` | `0x10ED43C718714eb63d5aA57B78B54704E256024E` | PancakeSwap V2 Router used for swaps |
| `lastSwapBackBlock()` | `0` | No tax swaps have occurred yet |
| `launchBlock()` | `0` | Anti-bot window unset; trading not enabled |
| `lpPair()` | `0xF4533e1462D67C3Dd2980cab4727b7EA021DE789` | WR/WBNB main AMM pair (taxes apply here) |
| `marketingAddress()` | `0xc1AD0b38030c11bA80f5D7f3dF1f964b782b5065` | Receives 60% of swapped ETH (owner-controlled) |
| `name()` | `White Rat` | Contract name identifier |
| `owner()` | `0xc1AD0b38030c11bA80f5D7f3dF1f964b782b5065` | Admin with authority over fees and settings |
| `sellTax()` | `500` | Current sell tax rate in basis points (5%) |
| `swapTokensAtAmt()` | `500000000000000000000` | Swap threshold (~0.05% of total supply) |
| `symbol()` | `WR` | Token ticker symbol |
| `totalSupply()` | `1000000000000000000000000` | Total minted tokens (9 decimals) |
| `tradingAllowed()` | `false` | Trading disallowed for non-exempt accounts |

### Findings Summary

| Severity | Count | Key Issues |
|---------|-------|------------|
| Critical | 0 | ‚Äî |
| High | 2 | Owner-controlled 90% tax window; Owner can set buy/sell taxes up to 30% anytime |
| Medium | 1 | Taxes apply only to one AMM pair; no management of additional pairs |
| Low | 3 | Anyone can force-send ETH to marketing (bypass 60/40 split); No reentrancy guard on tax swap path; Unlimited approve of owner to router |

### Critical Findings

No critical issues identified. No proxy/upgrade admin risk, and no hidden ownership backdoors or fake renunciation patterns detected.

### High Findings

---

#### üü† [H-1] Owner-controlled punitive 90% tax window duration via `enableTrading(uint256 _deadline)`

**Description:**
The owner can enable trading and set an arbitrary anti-bot window applying a 90% tax to buys and sells for `block.number <= launchBlock`. The window length equals `_deadline` blocks from activation, which can be set very high.

```solidity
function enableTrading(uint256 _deadline) external onlyOwner {
    require(!tradingAllowed, "Trading already enabled");
    tradingAllowed = true;
    lastSwapBackBlock = block.number;
    launchBlock = block.number + _deadline;
}

function handleTax(address from, address to, uint256 amount) internal returns (uint256) {
    // ...
    if (taxes.marketingTax > 0) {
        if (block.number <= launchBlock) {
            if (isAMMPair[from]) {
                tax = uint128((amount * 9000) / FEE_DIVISOR);
            } else if (isAMMPair[to]) {
                tax = uint128((amount * 9000) / FEE_DIVISOR);
            }
        } else {
            tax = uint128((amount * taxes.marketingTax) / FEE_DIVISOR);
        }
        super._transfer(from, address(this), tax);
    }
    return tax;
}
```

**Impact:**
Owner can enforce a prolonged or indefinite 90% tax period, severely harming buyers/sellers and accumulating large fees for the team. This can be used to extract value and deter normal trading.

**Location:**
`enableTrading()` and `handleTax()` logic controlling 90% tax based on `launchBlock`.

**üí° Recommendation:**
> **Action Required:** Limit `_deadline` to a short, reasonable number (e.g., <= 5 blocks) and enforce it with a `require`.
> 1. Add `require(_deadline <= X, "Anti-bot window too long")`
> 2. Emit event detailing the configured window for transparency
> - Alternative: Remove 90% branch entirely and rely on fixed low taxes

---

#### üü† [H-2] Owner can change buy/sell taxes up to 30% at any time

**Description:**
The owner can set buy and sell taxes up to 30% without time-lock or governance. Combined with fee exemption control, this creates a strong centralization risk.

```solidity
function updateTaxes(uint64 _buyMarketingTax, uint64 _sellMarketingTax) external onlyOwner {
    require(_buyMarketingTax <= 3000, "Buy tax cannot exceed 30%");
    require(_sellMarketingTax <= 3000, "Sell tax cannot exceed 30%");
    buyTax.marketingTax = _buyMarketingTax;
    sellTax.marketingTax = _sellMarketingTax;
}
```

**Impact:**
Unexpected fee increases can trap liquidity providers and traders, enabling value extraction by the team. Front-running around fee changes is also possible.

**Location:**
`updateTaxes()`.

**üí° Recommendation:**
> **Action Required:** Add safeguards to fee changes:
> 1. Lower maximums (e.g., cap at 5-10%)
> 2. Introduce a timelock (24-48h) for fee increases
> 3. Emit events and consider multi-sig governance approval

### Medium Findings

---

#### üü° [M-1] Taxes only apply to the single `lpPair`; no way to manage additional AMM pairs

**Description:**
Tax logic relies on `isAMMPair` mapping but only the constructor sets the initial pair. There is no function to add more pairs.

```solidity
address public immutable lpPair;
// ...
isAMMPair[lpPair] = true;
// No function to update/extend isAMMPair entries
```

**Impact:**
Trades through alternative pools (new pairs on AMMs) will be treated as normal transfers (0% tax), undermining tokenomics and enabling tax bypass.

**Location:**
Constructor and `isAMMPair` usage in `handleTax()`.

**üí° Recommendation:**
> **Action Required:** Add owner-governed management for AMM pairs:
> - `setAMMPair(address pair, bool value)` with event
> - Validate pairs via factory if necessary

### Low Findings

---

#### üü¢ [L-1] Anyone can force-send contract ETH to `marketingAddress` via `withdrawStuckBNB()`, bypassing 60/40 split

**Description:**
`withdrawStuckBNB()` is unrestricted and forwards 100% ETH balance to `marketingAddress`, bypassing the 60%/40% split implemented in `convertTaxes()`.

```solidity
function withdrawStuckBNB() external {
    bool success;
    (success, ) = address(marketingAddress).call{ value: address(this).balance }("");
}
```

**Impact:**
Third parties can trigger an immediate distribution solely to marketing, potentially depriving `devAddress` of its 40% share. Does not directly harm holders but deviates from intended split.

**Location:**
`withdrawStuckBNB()`.

**üí° Recommendation:**
> **Action Required:** Restrict function or honor split:
> 1. Add `onlyOwner` or split the balance 60/40 here as well
> 2. Emit event for transparency

---

#### üü¢ [L-2] No reentrancy guard around external calls in `convertTaxes()` and `swapTokensForETH()`

**Description:**
`convertTaxes()` calls the router and then makes `.call` to `marketingAddress` and `devAddress` (potentially contracts) without reentrancy protection.

```solidity
function convertTaxes() private {
    // ...
    swapTokensForETH(contractBalance);
    bool success;
    uint256 bnbBalance = address(this).balance;
    uint256 marketingShare = (bnbBalance * 60) / 100;
    if (marketingShare > 0) {
        (success, ) = marketingAddress.call{ value: marketingShare, gas: 35000 }("");
    }
    uint256 remainingBalance = address(this).balance;
    if (remainingBalance > 0) {
        (success, ) = devAddress.call{ value: remainingBalance, gas: 35000 }("");
    }
    lastSwapBackBlock = block.number;
}
```

**Impact:**
A malicious `marketingAddress`/`devAddress` contract could re-enter via ERC20 transfers during fallback. Current state changes and thresholds reduce practical impact, but a guard is recommended.

**Location:**
`convertTaxes()`.

**üí° Recommendation:**
> **Action Required:** Add nonReentrant guard or checks-effects-interactions discipline:
> 1. Use OpenZeppelin `ReentrancyGuard` for external call sites
> 2. Update state before external calls
> 3. Consider using pull payments or escrow

---

#### üü¢ [L-3] Unlimited approval from owner to router set to `totalSupply`

**Description:**
The constructor approves the router to spend the owner‚Äôs tokens up to `totalSupply`.

```solidity
_approve(address(msg.sender), address(dexRouter), totalSupply());
```

**Impact:**
Although PancakeRouter is trusted, large approvals increase blast radius in case of compromise or mis-use. Generally safe but avoidable.

**Location:**
Constructor.

**üí° Recommendation:**
> **Action Required:** Minimize approvals:
> 1. Approve exact amounts when needed
> 2. Reset allowance post-use

---

#### üü¢ [L-4] No events for tax updates and critical parameter changes

**Description:**
Functions like `updateTaxes`, `updateMarketingAddress`, `updateDevAddress`, `updateSwapTokensAmt` do not emit dedicated events (except fee exemptions).

```solidity
function updateTaxes(uint64 _buyMarketingTax, uint64 _sellMarketingTax) external onlyOwner {
    // no event
}
```

**Impact:**
Reduced transparency for off-chain monitoring and users; harder to track changes.

**Location:**
Owner-setter functions.

**üí° Recommendation:**
> **Action Required:** Emit events on every governance-sensitive change:
> - `TaxesUpdated`, `MarketingUpdated`, `DevUpdated`, `SwapThresholdUpdated`

### Good Practices

- Uses standard OZ-style `ERC20`, `SafeERC20`, and `Address` patterns; no suspicious library modifications detected.
- No proxy/upgradeability; implementation immutable.
- No blacklist, no arbitrary transfer blocking after trading enabled.
- Clear fee exemption control and bounded swap thresholds (0.001%‚Äì0.5% of supply).
- `renounceOwnership()` is a true renunciation with no restore backdoor present.

### Tokenomics Analysis

| Feature | Value/Status | Risk Assessment |
|---------|--------------|-----------------|
| Contract Type | Standard (non-proxy) | Low upgrade risk |
| Upgrade Control | N/A | ‚Äî |
| Ownership Status | Active (owner: `0xc1AD...5065`) | High centralization |
| Owner Address | `0xc1AD0b38030c11bA80f5D7f3dF1f964b782b5065` | Controls fees, exemptions |
| Total Supply | 1,000,000,000,000,000,000,000,000 (9 decimals) | Neutral |
| Buy Tax | 5% (max 30%) | High (owner-adjustable) |
| Sell Tax | 5% (max 30%) | High (owner-adjustable) |
| Max Transaction | None | Low restriction |

- Anti-bot window: After `enableTrading(_deadline)`, a 90% tax applies for `_deadline` blocks. This is owner-configurable and can be set high, creating severe temporary extraction risk.
- Fee routing: Swapped ETH is split 60% to `marketingAddress` and 40% to `devAddress`. Anyone can force-send the entire ETH balance to `marketingAddress` via `withdrawStuckBNB()`, skipping the intended split.
- Fee exemptions: Owner can exempt addresses from fees, allowing privileged trading.
- AMM pair scope: Only the initial `lpPair` is taxed. Additional pairs will not be taxed unless the code is extended, allowing tax avoidance via alternative pools.

Balanced Assessment: While upgradeability is not a concern, significant trust is required in the owner due to fee control and anti-bot settings. Users should monitor on-chain events and owner actions, and prefer multisig/timelocks for operational security.



---

## ‚ö†Ô∏è Important Disclaimer

> **This is an AI-generated audit and should NOT be considered as professional security advice.**

This automated analysis:
- ‚úÖ Provides quick security insights using advanced AI models
- ‚ùå May contain errors or miss critical vulnerabilities
- ‚ùå Cannot replace professional security audits
- ‚ùå Should not be used as the sole basis for investment decisions

**Always conduct thorough manual audits by qualified security professionals before:**
- Deploying smart contracts to production
- Investing significant funds
- Making critical security decisions

---

<sub>Generated by CheesePad AI Token Audit System</sub>
