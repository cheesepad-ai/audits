# üîç Goofi (GOOFI) - AI Security Audit

## üìä Audit Information

| Property | Value |
|----------|-------|
| **Audit Revision** | 1 |
| **Audit Date** | 2026-01-05T00:36:24.170Z (UTC) |
| **Blockchain** | BNB Smart Chain |
| **Contract Address** | `0xf3fee84e6492502ad427b98bc4edc4c449031b67` |
| **AI Models Used** | 1 model(s) |

## üìã Token Information

| Property | Value |
|----------|-------|
| **Token Name** | Goofi |
| **Symbol** | GOOFI |

---

## ü§ñ Analysis #1: GPT-5

**Completed:** Mon, 05 Jan 2026 00:36:24 GMT

### Summary

`BBADGER` (`Goofi` / `GOOFI`) is a tax-enabled `ERC20` on BSC with 9 decimals, swapping accumulated fees to BNB and distributing 60% to `marketingAddress` and 40% to `devAddress`. It gates trading via `tradingAllowed`, has an anti-bot window with 90% tax, and owner-controlled buy/sell taxes capped at 30%. Centralized controls (owner can change taxes/recipients; `marketingAddress` can seize tokens) present material trust risk despite otherwise standard mechanics. Overall Risk: HIGH ‚Äì Significant admin authority over fees and funds, plus token rescue privileges.

### Risk Assessment

**Token Quick Facts:**

| Property | Value | Status |
|----------|-------|--------|
| Buy Tax | 0% currently (configurable up to 30%) | ‚ö†Ô∏è High |
| Sell Tax | 0% currently (configurable up to 30%) | ‚ö†Ô∏è High |
| Max Transaction | None | ‚ö†Ô∏è Restrictive (None) |
| Contract Type | Standard | Info only |
| Ownership | Active (EOA) | ‚ö†Ô∏è Centralized |
| Pause Function | No (but `tradingAllowed` gate) | ‚ö†Ô∏è Can halt trading |

**Security Assessment:**

| Category | Risk Level | Notes |
|----------|------------|-------|
| Security | Medium | No critical bugs; some logic issues and MEV exposure on swaps |
| Centralization | High | Owner can set high taxes; `marketingAddress` can seize tokens |
| Code Quality | Medium | Generally OZ-like; some unchecked external calls and misnamed params |
| Exploit Likelihood | Medium | Most risks stem from admin actions, not pure exploits |
| **Overall Risk Score** | **80/100** | 0 Critical, 2 High, 2 Medium, 4 Low |

## On-Chain Function Results

The following functions were called on-chain at block 74094602. The table below shows the results:

| Function | On-Chain Value | Explanation |
|----------|----------------|-------------|
| `DEAD()` | `0x000000000000000000000000000000000000dEaD` | Burn address to permanently remove tokens/LP |
| `FEE_DIVISOR()` | `10000` | Basis points divisor for fee calculations (10000 = 100%) |
| `WETH()` | `0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c` | WBNB address used for swaps/liquidity |
| `buyTax()` | `0` | Current buy marketing tax (basis points); 0 bps = 0% |
| `decimals()` | `9` | Token display precision |
| `devAddress()` | `0x3695f137a95DC3Da5A221e3dd71A663Fb2f7befA` | Receives 40% of swap BNB from taxes |
| `dexRouter()` | `0x10ED43C718714eb63d5aA57B78B54704E256024E` | PancakeSwap V2 router |
| `lastSwapBackBlock()` | `0` | Last block a tax swap ran; 0 means never |
| `launchBlock()` | `0` | End of anti-bot window; 0 means disabled/not set |
| `lpPair()` | `0x090B3d07BAe01254730ab2396874bCaBC1093231` | PancakeSwap token-WBNB pair |
| `marketingAddress()` | `0x3695f137a95DC3Da5A221e3dd71A663Fb2f7befA` | Receives 60% of swap BNB from taxes |
| `name()` | `Goofi` | Contract name identifier |
| `owner()` | `0x3695f137a95DC3Da5A221e3dd71A663Fb2f7befA` | Admin with authority to change settings |
| `sellTax()` | `0` | Current sell marketing tax (basis points); 0 bps = 0% |
| `swapTokensAtAmt()` | `3000000000000000` | Tax swap threshold (0.3% of supply) |
| `symbol()` | `GOOFI` | Token ticker |
| `totalSupply()` | `1000000000000000000` | Total minted: 1,000,000,000 tokens (9 decimals) |
| `tradingAllowed()` | `false` | Trading disabled until enabled by owner |

### Findings Summary

| Severity | Count | Key Issues |
|---------|-------|------------|
| Critical | 0 | ‚Äî |
| High | 2 | Admin can raise taxes to 30% and enable 90% anti-bot tax; `marketingAddress` can seize tokens via `rescueTokens()` |
| Medium | 2 | Anyone can redirect stuck BNB fully to marketing; Only one AMM pair taxed (tax evasion via alternate pairs) |
| Low | 4 | Ignored success on ETH payouts; `amountOutMin=0` on swaps; misleading `_deadline` naming; missing events for key updates |

### Critical Findings

None identified.

### High Findings

---

#### üü† [H-1] Admin-configurable taxes up to 30% and 90% anti-bot tax window can be abused

**Description:**
Owner can set `buyTax.marketingTax` and `sellTax.marketingTax` up to 30% at any time. Additionally, during the anti-bot window (`block.number <= launchBlock`), buys/sells incur a 90% tax. The anti-bot window length is fully controlled by owner via `enableTrading(uint256 _deadline)` which sets `launchBlock = block.number + _deadline`.

```solidity
function updateTaxes(uint64 _buyMarketingTax, uint64 _sellMarketingTax) external onlyOwner {
    require(_buyMarketingTax <= 3000, "Buy tax cannot exceed 30%");
    require(_sellMarketingTax <= 3000, "Sell tax cannot exceed 30%");
    buyTax.marketingTax = _buyMarketingTax;
    sellTax.marketingTax = _sellMarketingTax;
}

function enableTrading(uint256 _deadline) external onlyOwner {
    require(!tradingAllowed, "Trading already enabled");
    tradingAllowed = true;
    lastSwapBackBlock = block.number;
    launchBlock = block.number + _deadline;
}

if (block.number <= launchBlock) {
    if (isAMMPair[from]) {
        tax = uint128((amount * 9000) / FEE_DIVISOR);
    } else if (isAMMPair[to]) {
        tax = uint128((amount * 9000) / FEE_DIVISOR);
    }
}
```

**Impact:**
Owner can at any moment:
- Raise buy/sell taxes to 30% (confiscatory fee).
- Set a long anti-bot window for 90% effective tax on AMM trades.
This can effectively trap or severely penalize traders and drain value to the team wallets via tax swaps.

**Location:**
`updateTaxes()`; `enableTrading()`; `handleTax()` within `BBADGER`.

**üí° Recommendation:**
> **Action Required:** Reduce trust assumptions:
> 1. Lower max tax caps (e.g., ‚â§5%) enforced on-chain
> 2. Hard-cap anti-bot window duration (e.g., ‚â§2 blocks) or remove it
> 3. Consider time-locking tax changes and broadcasting events in advance
> - Alternative: Governance/multisig-controlled parameter updates

---

#### üü† [H-2] `marketingAddress` can seize any ERC20 (including this token) from the contract via `rescueTokens()`

**Description:**
`rescueTokens()` allows `marketingAddress` (not `owner`) to transfer the contract‚Äôs entire balance of any ERC20, including `address(this)`, to itself. This lets the marketing wallet drain accumulated tax tokens before they are swapped, or any other assets sent to the contract.

```solidity
function rescueTokens(address _token) external {
    require(msg.sender == marketingAddress, "Not marketing");
    require(_token != address(0), "_token address cannot be 0");
    uint256 _contractBalance = IERC20(_token).balanceOf(address(this));
    SafeERC20.safeTransfer(IERC20(_token), address(marketingAddress), _contractBalance);
}
```

**Impact:**
- Team can bypass the swap/distribution logic, seize all tax-accrued tokens, then sell them, impacting price/liquidity (rug risk).
- Post-ownership renounce, `marketingAddress` retains this power, undermining perceived decentralization.

**Location:**
`rescueTokens()` in `BBADGER`.

**üí° Recommendation:**
> **Action Required:** Restrict or remove seize capability:
> 1. Forbid rescuing `address(this)` or LP tokens
> 2. Gate with multisig and timelock; emit events
> 3. If needed for recovery, cap amount and restrict to non-core assets

---

### Medium Findings

---

#### üü° [M-1] Anyone can redirect all stuck BNB to `marketingAddress` via `withdrawStuckBNB()`

**Description:**
`withdrawStuckBNB()` is permissionless and transfers the entire contract BNB balance to `marketingAddress`, bypassing the intended 60/40 split in `convertTaxes()`. No checks on `success`.

```solidity
function withdrawStuckBNB() external {
    bool success;
    (success, ) = address(marketingAddress).call{ value: address(this).balance }("");
}
```

**Impact:**
- Any user can forcefully redirect all ETH/BNB in the contract to `marketingAddress`, depriving `devAddress` of its share.
- Funds distribution is inconsistent and can be griefed.

**Location:**
`withdrawStuckBNB()` in `BBADGER`.

**üí° Recommendation:**
> **Action Required:**
> 1. Restrict to `onlyOwner` or `onlyMarketing` and preserve the intended split
> 2. Track pending balances and distribute via controlled function with success checks

---

#### üü° [M-2] Only one AMM pair is taxed; alternate pairs can evade taxes

**Description:**
Only the initially created `lpPair` is marked as AMM. There is no function to add additional AMM pairs (e.g., other DEXes or additional pools).

```solidity
lpPair = IDexFactory(dexRouter.factory()).createPair(address(this), WETH);
isAMMPair[lpPair] = true;
```

**Impact:**
- Anyone can create a new liquidity pair where buys/sells are treated as wallet-to-wallet transfers (0% tax).
- Undermines project revenue and tax policy enforcement.

**Location:**
Constructor of `BBADGER`; absent admin function to manage `isAMMPair`.

**üí° Recommendation:**
> **Action Required:** Add admin-managed allowlist:
> 1. Implement `setAMMPair(address pair, bool value)` with events
> 2. Initialize with common routers/pairs; consider auto-detection safeguards

---

### Low Findings

---

#### üü¢ [L-1] ETH/BNB payouts in `convertTaxes()` ignore call success

**Description:**
The contract attempts to pay `marketingAddress` and `devAddress` with fixed gas (35,000) and ignores `success`. Failed transfers leave funds stranded until someone calls `withdrawStuckBNB()`.

```solidity
(success, ) = marketingAddress.call{ value: marketingShare, gas: 35000 }("");
...
(success, ) = devAddress.call{ value: remainingBalance, gas: 35000 }("");
```

**Impact:**
- If recipients are contracts or require more gas, payments silently fail and BNB accumulates.
- Dev may never receive funds if `withdrawStuckBNB()` is used.

**Location:**
`convertTaxes()` in `BBADGER`.

**üí° Recommendation:**
> **Action Required:**
> 1. Check `success` and handle failures (e.g., accumulate owed balances)
> 2. Consider removing fixed gas; use pull-payment pattern

---

#### üü¢ [L-2] `amountOutMin = 0` in swaps exposes tax swaps to MEV slippage

**Description:**
Tax swap uses zero minimum output, making it vulnerable to price manipulation.

```solidity
dexRouter.swapExactTokensForETHSupportingFeeOnTransferTokens(
    tokenAmt, 0, path, address(this), block.timestamp
);
```

**Impact:**
- MEV bots can sandwich front-run to reduce BNB received for tax swaps.

**Location:**
`swapTokensForETH()` in `BBADGER`.

**üí° Recommendation:**
> **Action Required:**
> 1. Consider mild slippage protections (e.g., TWAP/Oracle, or time-weighted sells)
> 2. Limit per-swap size (already capped at 4x threshold helps)

---

#### üü¢ [L-3] Misleading parameter naming: `_deadline` used as anti-bot block window length

**Description:**
`enableTrading(uint256 _deadline)` sets `launchBlock = block.number + _deadline` where `_deadline` is not a timestamp deadline but a block offset for the 90% tax window.

```solidity
launchBlock = block.number + _deadline;
```

**Impact:**
- Confusing semantics can cause operator mistakes (e.g., passing seconds instead of blocks).

**Location:**
`enableTrading()` in `BBADGER`.

**üí° Recommendation:**
> **Action Required:**
> 1. Rename parameter to `_antiBotBlocks`
> 2. Add comments and cap maximum allowed blocks

---

#### üü¢ [L-4] No events emitted for critical parameter updates

**Description:**
Changes to `marketingAddress`, `devAddress`, and taxes do not emit events (except `SetExemptFromFees`).

```solidity
function updateMarketingAddress(address _address) external onlyOwner { ... }
function updateDevAddress(address _address) external onlyOwner { ... }
function updateTaxes(uint64 _buyMarketingTax, uint64 _sellMarketingTax) external onlyOwner { ... }
```

**Impact:**
- Off-chain monitoring and transparency are reduced; harder for users to track governance changes.

**Location:**
Admin functions in `BBADGER`.

**üí° Recommendation:**
> **Action Required:**
> 1. Emit explicit events for each update (e.g., `MarketingUpdated`, `DevUpdated`, `TaxesUpdated`)
> 2. Index key fields for discoverability

---

### Good Practices

- Uses Solidity 0.8.26 with built-in overflow checks; arithmetic guarded or intentionally `unchecked` where safe.
- ERC20 implementation closely follows OpenZeppelin patterns; `decimals()` overridden to 9.
- Tax swap limited per block and capped by threshold multipliers to reduce gas/price impact.
- No upgradeability/proxy pattern detected; no ownership restore/backdoor functions observed.
- Anti-reentrancy posture aided by fixed-gas ETH sends and limited external calls during transfers.

### Tokenomics Analysis

| Feature | Value/Status | Risk Assessment |
|---------|--------------|-----------------|
| Contract Type | Standard | Low (no proxy) |
| Upgrade Control | None | Low |
| Ownership Status | Active (`0x3695...befA`) | High (centralized) |
| Owner Address | 0x3695f137a95DC3Da5A221e3dd71A663Fb2f7befA | Current owner |
| Total Supply | 1,000,000,000 (9 decimals) | Low |
| Buy Tax | 0% at block 74094602 (configurable ‚â§30%) | High |
| Sell Tax | 0% at block 74094602 (configurable ‚â§30%) | High |
| Max Transaction | None | Medium (no anti-whale) |

Mechanics:
- Taxes accrue in the contract and are swapped to BNB when `balanceOf(this) >= swapTokensAtAmt` (0.3% of supply, capped to 4x per swap). Proceeds: 60% to `marketingAddress`, 40% to `devAddress`. 
- Early anti-bot window applies 90% tax on AMM buys/sells until `block.number > launchBlock` (owner-defined length). 
- Centralization: Owner can change taxes (‚â§30%), toggle exemptions, update marketing/dev wallets, and control trading start. `marketingAddress` can unilaterally seize any ERC20 from the contract (including this token), enabling extraction of taxed tokens prior to swapping (rug risk). 
- Tax scope: Only the initially created Pancake pair is flagged; other pairs remain untaxed, allowing tax evasion and potential routing around fees.

Balanced Assessment: While upgrade risk is low (no proxy), users must trust the owner/marketing to operate taxes and distributions fairly. The ability to set high taxes and to seize tokens from the contract are the primary rug vectors.

---

## ‚ö†Ô∏è Important Disclaimer

> **This is an AI-generated audit and should NOT be considered as professional security advice.**

This automated analysis:
- ‚úÖ Provides quick security insights using advanced AI models
- ‚ùå May contain errors or miss critical vulnerabilities
- ‚ùå Cannot replace professional security audits
- ‚ùå Should not be used as the sole basis for investment decisions

**Always conduct thorough manual audits by qualified security professionals before:**
- Deploying smart contracts to production
- Investing significant funds
- Making critical security decisions

---

<sub>Generated by CheesePad AI Token Audit System</sub>
