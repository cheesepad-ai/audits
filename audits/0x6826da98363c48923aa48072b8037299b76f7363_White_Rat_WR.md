# üîç White Rat (WR) - AI Security Audit

## üìä Audit Information

| Property | Value |
|----------|-------|
| **Audit Revision** | 1 |
| **Audit Date** | 2025-11-22T11:32:00.818Z (UTC) |
| **Blockchain** | BNB Smart Chain |
| **Contract Address** | `0x6826da98363c48923aa48072b8037299b76f7363` |
| **AI Models Used** | 1 model(s) |

## üìã Token Information

| Property | Value |
|----------|-------|
| **Token Name** | White Rat |
| **Symbol** | WR |

---

## ü§ñ Analysis #1: GPT-5

**Completed:** Sat, 22 Nov 2025 11:32:00 GMT

### Summary

This is a taxed `ERC20` token (`WR`) on BSC with 9 decimals, PancakeSwap v2 integration, and a contract-side tax swap distributing ETH 60% to `marketingAddress` and 40% to `devAddress`. Key features include a trading gate (`tradingAllowed`), a configurable anti-bot launch window imposing a 90% buy/sell tax, and owner-controlled fee exemptions. Overall this design is centralized and allows the owner to control trading start and privileged exemptions; no upgradeability or ownership backdoors were found. Overall Risk: HIGH - Owner-controlled launch window (90% tax), exemptions, and centralized fee extraction.

### Risk Assessment

**Token Quick Facts:**

| Property | Value | Status |
|----------|-------|--------|
| Buy Tax | 5% (marketing) | ‚ö†Ô∏è Moderate |
| Sell Tax | 5% (marketing) | ‚ö†Ô∏è Moderate |
| Max Transaction | None | ‚ö†Ô∏è Restrictive controls absent |
| Contract Type | Standard | Info only |
| Ownership | Active | ‚ö†Ô∏è Centralized |
| Pause Function | No (trading gate only) | ‚ö†Ô∏è Can halt public trading pre-launch |

**Security Assessment:**

| Category | Risk Level | Notes |
|----------|------------|-------|
| Security | Medium | No reentrancy/overflow issues found; swapback safe; some logic risks |
| Centralization | High | Owner can gate trading, set exemptions; marketing/dev capture fees |
| Code Quality | Medium | Mostly OZ-like; some minor logic/design pitfalls |
| Exploit Likelihood | Medium | Economic/launch timing risks more likely than technical exploits |
| **Overall Risk Score** | **77/100** | High centralization and launch-window tax risk, otherwise standard mechanics |

## On-Chain Function Results

| Function | On-Chain Value | Explanation |
|----------|----------------|-------------|
| `DEAD()` | `0x000000000000000000000000000000000000dEaD` | Burn address; commonly used to lock tokens |
| `FEE_DIVISOR()` | `10000` | Basis points divisor; 10000 = 100% |
| `WETH()` | `0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c` | Wrapped BNB used for swaps and liquidity |
| `buyTax()` | `500` | Buy-side marketing tax rate: 5% (500 bps) |
| `decimals()` | `9` | Token uses 9 decimals |
| `devAddress()` | `0xc1AD0b38030c11bA80f5D7f3dF1f964b782b5065` | Receives 40% of tax ETH |
| `dexRouter()` | `0x10ED43C718714eb63d5aA57B78B54704E256024E` | PancakeSwap v2 Router address |
| `lastSwapBackBlock()` | `0` | Block of last tax-swap; 0 means none yet |
| `launchBlock()` | `0` | End block for 90% anti-bot tax; unset pre-launch |
| `lpPair()` | `0xfF8BD7b3E39C48F12319bd3Efea9217bDe9525bd` | WR/WBNB Pancake v2 pair |
| `marketingAddress()` | `0xc1AD0b38030c11bA80f5D7f3dF1f964b782b5065` | Receives 60% of tax ETH and withdrawals |
| `name()` | `White Rat` | Contract name identifier |
| `owner()` | `0xc1AD0b38030c11bA80f5D7f3dF1f964b782b5065` | Admin with power to change settings |
| `sellTax()` | `500` | Sell-side marketing tax rate: 5% (500 bps) |
| `swapTokensAtAmt()` | `500000000000000000000` | Swap threshold: 0.05% of total supply |
| `symbol()` | `WR` | Token ticker |
| `totalSupply()` | `1000000000000000000000000` | 1e24 base units (1e15 tokens at 9 decimals) |
| `tradingAllowed()` | `false` | Trading gate off; only exempt addresses can transfer |

### Findings Summary

| Severity | Count | Key Issues |
|---------|-------|------------|
| Critical | 0 | ‚Äî |
| High | 3 | Arbitrary 90% launch tax window; Owner-controlled exemptions bypass trading/taxes; Centralized fee capture to EOAs |
| Medium | 3 | Withdrawal bypasses 60/40 split; Fixed 35k gas in payouts; Taxes bypassable via alternate pairs |
| Low | 2 | Unused `DEAD` constant; Constructor approves router for owner unnecessarily |

### Critical Findings

None.

### High Findings

---

#### üü† [H-1] Arbitrary-length 90% anti-bot tax window at launch

**Description:**
Owner sets `launchBlock` as `block.number + _deadline` in `enableTrading()`, and any buy/sell while `block.number <= launchBlock` incurs a 90% tax. There is no upper bound on `_deadline`.

```solidity
function enableTrading(uint256 _deadline) external onlyOwner {
    require(!tradingAllowed, "Trading already enabled");
    tradingAllowed = true;
    lastSwapBackBlock = block.number;
    launchBlock = block.number + _deadline;
}

if (taxes.marketingTax > 0) {
    if(block.number <= launchBlock){
        if (isAMMPair[from]){
            tax = uint128(amount * 9000 / FEE_DIVISOR);
        } else if (isAMMPair[to]) {
            tax = uint128(amount * 9000 / FEE_DIVISOR);
        }
    } else {
        tax = uint128(amount * taxes.marketingTax / FEE_DIVISOR);
    }
    super._transfer(from, address(this), tax);
}
```

**Impact:**
Owner can set `_deadline` extremely high, enforcing a confiscatory 90% tax for a long period post-launch. This creates rug-like economic risk and enables severe value extraction from traders during the anti-bot phase.

**Location:**
`enableTrading()` and `handleTax()` anti-bot condition.

**üí° Recommendation:**
> **Action Required:** Cap the anti-bot window.
> 1. Enforce a strict upper bound (e.g., `_deadline <= 2` blocks).
> 2. Emit events with the selected value; publish parameters before launch.
> - Alternative: Replace block-based anti-bot with small, time-limited max tax (e.g., <= 20%).

---

#### üü† [H-2] Owner-controlled exemptions can bypass trading gate and taxes

**Description:**
Transfers only enforce `tradingAllowed` and taxes if both `from` and `to` are not exempt. Owner can arbitrarily toggle exemptions, enabling privileged trading and tax-free transfers.

```solidity
function _transfer(address from, address to, uint256 amount) internal virtual override {
    if (!exemptFromFees[from] && !exemptFromFees[to]) {
        require(tradingAllowed, "Trading not active");
        amount -= handleTax(from, to, amount);
    }
    super._transfer(from, to, amount);
}

function setExemptFromFee(address _address, bool _isExempt) external onlyOwner {
    require(_address != address(0), "Zero Address");
    require(_address != address(this), "Cannot unexempt contract");
    exemptFromFees[_address] = _isExempt;
    emit SetExemptFromFees(_address, _isExempt);
}
```

**Impact:**
- Team can trade pre-launch or tax-free.
- Selective exemptions enable unfair market advantages and potential stealth launches.
- Users must fully trust the owner for fair trading conditions.

**Location:**
`_transfer()` gate and `setExemptFromFee()`.

**üí° Recommendation:**
> **Action Required:** Limit and audit exemptions.
> 1. Restrict exemptions to essential system addresses only.
> 2. Make trading go-live irreversible and not bypassable by exemptions for AMM pairs.
> - Alternative: Introduce a public timelock and emit detailed events for all exemptions.

---

#### üü† [H-3] Centralized control of fee revenue and payouts to EOAs

**Description:**
All swap-converted ETH is sent to `marketingAddress` (60%) and `devAddress` (40%), both arbitrary EOAs controlled by the owner. No multisig/timelock safeguards. A separate withdrawal function can send all ETH to `marketingAddress`.

```solidity
// convertTaxes()
uint256 marketingShare = (bnbBalance * 60) / 100;
(success, ) = marketingAddress.call{ value: marketingShare, gas: 35000 }("");
uint256 remainingBalance = address(this).balance;
(success, ) = devAddress.call{ value: remainingBalance, gas: 35000 }("");

// withdrawStuckBNB()
(success, ) = address(marketingAddress).call{ value: address(this).balance }("");
```

**Impact:**
- Complete trust in a single EOA; compromise or malicious action can drain funds.
- Withdrawal function allows immediate full sweep to `marketingAddress`, bypassing proportionate split.

**Location:**
`convertTaxes()` and `withdrawStuckBNB()`.

**üí° Recommendation:**
> **Action Required:** Add operational safeguards.
> 1. Use a 3/5 multisig for `marketingAddress` and `devAddress`.
> 2. Add a timelock (24‚Äì48h) for address changes.
> - Alternative: Stream payouts via vesting contracts instead of direct EOAs.

---

### Medium Findings

---

#### üü° [M-1] `withdrawStuckBNB()` bypasses the 60/40 split; anyone can trigger timing

**Description:**
`withdrawStuckBNB()` sends 100% of the contract‚Äôs ETH to `marketingAddress`, ignoring the 60/40 split defined in `convertTaxes()`. It is externally callable by anyone.

```solidity
function withdrawStuckBNB() external {
    bool success;
    (success, ) = address(marketingAddress).call{ value: address(this).balance }("");
}
```

**Impact:**
- Dev share can be skipped if ETH accumulates (e.g., due to previous failed payouts or incidental ETH).
- Third parties can force immediate withdrawal timing to `marketingAddress`.

**Location:**
`withdrawStuckBNB()`.

**üí° Recommendation:**
> **Action Required:** Honor the designed split.
> 1. Have `withdrawStuckBNB()` split ETH according to the configured ratio.
> 2. Restrict function to owner or both payout addresses via multisig.

---

#### üü° [M-2] Fixed 35,000 gas stipend may break payouts for contract recipients

**Description:**
Marketing/dev payouts use a fixed 35k gas stipend, which may be insufficient for some receiving contracts, causing funds to remain in the token contract until `withdrawStuckBNB()` is used.

```solidity
(success, ) = marketingAddress.call{ value: marketingShare, gas: 35000 }("");
(success, ) = devAddress.call{ value: remainingBalance, gas: 35000 }("");
```

**Impact:**
- ETH can accumulate if recipients are contracts requiring more gas.
- Inconsistent payout behavior; necessitates out-of-band withdrawals.

**Location:**
`convertTaxes()`.

**üí° Recommendation:**
> **Action Required:** Improve payout robustness.
> 1. Avoid fixed stipends; forward all gas or use pull-based withdrawals.
> 2. If using contracts, implement minimal receive/fallbacks.

---

#### üü° [M-3] Taxes can be bypassed via unrecognized AMM pairs

**Description:**
Taxes apply only when interacting with addresses flagged in `isAMMPair`. There is no function to add new pairs, so trading via other liquidity pools can avoid taxes.

```solidity
mapping(address => bool) public isAMMPair;
// only constructor-set:
isAMMPair[lpPair] = true;

// handleTax picks buy/sell taxes only if isAMMPair[from/to]
```

**Impact:**
Attackers can create alternative pairs and trade tax-free, undermining tokenomics and expected revenue.

**Location:**
`isAMMPair` usage in `handleTax()`.

**üí° Recommendation:**
> **Action Required:** Maintain pair registry.
> 1. Add `onlyOwner` function to add/remove AMM pairs.
> 2. Optionally tax any transfer involving known DEX routers/factories.

---

### Low Findings

---

#### üü¢ [L-1] Unused constant `DEAD`

**Description:**
The `DEAD` address constant is declared but never used.

```solidity
address public constant DEAD = 0x000000000000000000000000000000000000dEaD;
```

**Impact:**
Minor code clarity issue.

**Location:**
`WR` contract constants.

**üí° Recommendation:**
> **Action Required:** Remove unused constants or use them for intended burn/lock operations.

---

#### üü¢ [L-2] Redundant router approval for owner in constructor

**Description:**
Constructor grants the router allowance from the deployer equal to `totalSupply`, which may be unnecessary or surprising.

```solidity
_approve(address(msg.sender), address(dexRouter), totalSupply());
```

**Impact:**
No direct vulnerability; potential confusion or unintended allowance if deployer changes.

**Location:**
`WR` constructor.

**üí° Recommendation:**
> **Action Required:** Remove redundant approvals; approve only on demand where needed.

---

### Good Practices

- Uses Solidity 0.8.26 (built-in overflow/underflow checks)
- No proxy/upgradeability pattern (lower upgrade risk)
- Ownership renunciation properly zeroizes `owner` with no restore backdoor
- Taxes are hardcoded at 5% buy/sell and not adjustable by owner
- Swapback gated to avoid multiple swaps per block

### Tokenomics Analysis

| Feature | Value/Status | Risk Assessment |
|---------|--------------|-----------------|
| Contract Type | Standard | Lower technical risk |
| Upgrade Control | None (not upgradeable) | Low |
| Ownership Status | Active | High (centralized control) |
| Owner Address | 0xc1AD...5065 | Single EOA |
| Total Supply | 1e24 base units (1e15 tokens) | Standard large supply |
| Buy Tax | 5% (to contract ‚Üí marketing/dev) | Moderate |
| Sell Tax | 5% (to contract ‚Üí marketing/dev) | Moderate |
| Max Transaction | None | Users can face high slippage only |

Detailed:
- Fees: 5% on buys/sells go to the contract, swapped for WBNB‚ÜíETH, then split 60% to `marketingAddress` and 40% to `devAddress`. The owner cannot change tax rates in code, but can change payout addresses and grant exemptions to bypass taxes.
- Launch anti-bot: Owner-defined window with 90% tax applied to buys and sells while `block.number <= launchBlock`. Because `_deadline` is unbounded, this can be made very long at launch, effectively creating a confiscatory tax period.
- Centralization: Fee revenue and operational control are concentrated in a single EOA (per on-chain data, both `owner`, `marketingAddress`, and `devAddress` are the same address). No multisig/timelock controls exist.
- Liquidity: Pair is created with Pancake v2; contract approves router; no functions to manage LP or detect new AMM pairs. Taxes can be bypassed via alternate pools not in `isAMMPair`.

Balanced Assessment: While upgradeability is absent (reducing upgrade risk), the tokenomics concentrate significant control in the owner and payout addresses. The unbounded 90% launch tax window and exemptions magnify trust risk despite fixed fee rates. Users must trust the owner to enable trading promptly, avoid abusive anti-bot windows, and manage exemptions fairly.

---

## ‚ö†Ô∏è Important Disclaimer

> **This is an AI-generated audit and should NOT be considered as professional security advice.**

This automated analysis:
- ‚úÖ Provides quick security insights using advanced AI models
- ‚ùå May contain errors or miss critical vulnerabilities
- ‚ùå Cannot replace professional security audits
- ‚ùå Should not be used as the sole basis for investment decisions

**Always conduct thorough manual audits by qualified security professionals before:**
- Deploying smart contracts to production
- Investing significant funds
- Making critical security decisions

---

<sub>Generated by CheesePad AI Token Audit System</sub>
